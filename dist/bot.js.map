{"version":3,"sources":["../src/bot.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport {Client, Collection, Command, GatewayIntentBits, Partials} from \"discord.js\";\nimport dotenv from \"dotenv\";\nimport fs from \"node:fs\";\nimport path from \"node:path\";\nimport {fileURLToPath, pathToFileURL} from \"url\";\nimport {interactionProcessors} from \"./utils.js\";\nimport {initClient} from \"./services/cmcApi.js\";\n\ndotenv.config();\nconst client = new Client({\n    intents: [\n        GatewayIntentBits.Guilds,\n        GatewayIntentBits.DirectMessages\n    ],\n    partials: [\n        Partials.Channel\n    ],\n    shards: \"auto\"\n});\ninitClient(client);\nconst cwd = path.dirname(fileURLToPath(import.meta.url));\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nawait importFromDir(path.join(cwd, \"services\"), (_module: any) => {\n    return; //importing = running top level stuff\n});\nawait importFromDir(path.join(cwd, \"events\"), (module: any) => {\n    const event = module.default;\n    if (event.once) {\n        client.once(event.name, (...args) => event.execute(...args));\n    } else {\n        client.on(event.name, (...args) => event.execute(...args));\n    }\n});\nclient.commands = new Collection();\nawait importFromDir(path.join(cwd, \"commands\"), (module: any) => {\n    const command: Command = module.default;\n    client.commands.set(command.data.name, command);\n});\nawait importInteractionProcessors(path.join(cwd, \"ui\"));\n\nclient.login(process.env[\"BOT_TOKEN\"]);\n\n/**use type any for modules*/\nasync function importFromDir(curDir: string, modifier: (module: any) => void) {\n    const files = fs.readdirSync(curDir);\n    for (const file of files) {\n        const filePath = path.join(curDir, file);\n        if (file.endsWith(\".js\")) {\n            modifier(await import(pathToFileURL(filePath).toString()));\n        } else if (fs.lstatSync(filePath).isDirectory()) {\n            await importFromDir(filePath, modifier);\n        }\n    }\n}\n\nasync function importInteractionProcessors(curDir: string) {\n    const files = fs.readdirSync(curDir);\n    for (const file of files) {\n        const filePath = path.join(curDir, file);\n        const folderName = path.basename(path.resolve(curDir));\n        if (file.endsWith(\".js\") && folderName != \"ui\" && file.startsWith(\"interactionProcessor\")) {\n            const {default: module} = await import(pathToFileURL(filePath).toString());\n            interactionProcessors.set(folderName, module);\n        } else if (fs.lstatSync(filePath).isDirectory()) {\n            await importInteractionProcessors(filePath);\n        }\n    }\n}\n"],"names":["Client","Collection","GatewayIntentBits","Partials","dotenv","fs","path","fileURLToPath","pathToFileURL","interactionProcessors","initClient","config","client","intents","Guilds","DirectMessages","partials","Channel","shards","cwd","dirname","url","importFromDir","join","_module","module","event","default","once","name","args","execute","on","commands","command","set","data","importInteractionProcessors","login","process","env","curDir","modifier","files","readdirSync","file","filePath","endsWith","toString","lstatSync","isDirectory","folderName","basename","resolve","startsWith"],"mappings":"AAAA,qDAAqD,GACrD,SAAQA,MAAM,EAAEC,UAAU,EAAWC,iBAAiB,EAAEC,QAAQ,QAAO,aAAa;AACpF,OAAOC,YAAY,SAAS;AAC5B,OAAOC,QAAQ,UAAU;AACzB,OAAOC,UAAU,YAAY;AAC7B,SAAQC,aAAa,EAAEC,aAAa,QAAO,MAAM;AACjD,SAAQC,qBAAqB,QAAO,aAAa;AACjD,SAAQC,UAAU,QAAO,uBAAuB;AAEhDN,OAAOO,MAAM;AACb,MAAMC,SAAS,IAAIZ,OAAO;IACtBa,SAAS;QACLX,kBAAkBY,MAAM;QACxBZ,kBAAkBa,cAAc;KACnC;IACDC,UAAU;QACNb,SAASc,OAAO;KACnB;IACDC,QAAQ;AACZ;AACAR,WAAWE;AACX,MAAMO,MAAMb,KAAKc,OAAO,CAACb,cAAc,YAAYc,GAAG;AACtD,6DAA6D;AAC7D,MAAMC,cAAchB,KAAKiB,IAAI,CAACJ,KAAK,aAAa,CAACK,UAAiB;IAC9D,QAAQ,qCAAqC;AACjD;AACA,MAAMF,cAAchB,KAAKiB,IAAI,CAACJ,KAAK,WAAW,CAACM,SAAgB;IAC3D,MAAMC,QAAQD,OAAOE,OAAO;IAC5B,IAAID,MAAME,IAAI,EAAE;QACZhB,OAAOgB,IAAI,CAACF,MAAMG,IAAI,EAAE,CAAC,GAAGC,OAASJ,MAAMK,OAAO,IAAID;IAC1D,OAAO;QACHlB,OAAOoB,EAAE,CAACN,MAAMG,IAAI,EAAE,CAAC,GAAGC,OAASJ,MAAMK,OAAO,IAAID;IACxD,CAAC;AACL;AACAlB,OAAOqB,QAAQ,GAAG,IAAIhC;AACtB,MAAMqB,cAAchB,KAAKiB,IAAI,CAACJ,KAAK,aAAa,CAACM,SAAgB;IAC7D,MAAMS,UAAmBT,OAAOE,OAAO;IACvCf,OAAOqB,QAAQ,CAACE,GAAG,CAACD,QAAQE,IAAI,CAACP,IAAI,EAAEK;AAC3C;AACA,MAAMG,4BAA4B/B,KAAKiB,IAAI,CAACJ,KAAK;AAEjDP,OAAO0B,KAAK,CAACC,QAAQC,GAAG,CAAC,YAAY;AAErC,2BAA2B,GAC3B,eAAelB,cAAcmB,MAAc,EAAEC,QAA+B,EAAE;IAC1E,MAAMC,QAAQtC,GAAGuC,WAAW,CAACH;IAC7B,KAAK,MAAMI,QAAQF,MAAO;QACtB,MAAMG,WAAWxC,KAAKiB,IAAI,CAACkB,QAAQI;QACnC,IAAIA,KAAKE,QAAQ,CAAC,QAAQ;YACtBL,SAAS,MAAM,MAAM,CAAClC,cAAcsC,UAAUE,QAAQ;QAC1D,OAAO,IAAI3C,GAAG4C,SAAS,CAACH,UAAUI,WAAW,IAAI;YAC7C,MAAM5B,cAAcwB,UAAUJ;QAClC,CAAC;IACL;AACJ;AAEA,eAAeL,4BAA4BI,MAAc,EAAE;IACvD,MAAME,QAAQtC,GAAGuC,WAAW,CAACH;IAC7B,KAAK,MAAMI,QAAQF,MAAO;QACtB,MAAMG,WAAWxC,KAAKiB,IAAI,CAACkB,QAAQI;QACnC,MAAMM,aAAa7C,KAAK8C,QAAQ,CAAC9C,KAAK+C,OAAO,CAACZ;QAC9C,IAAII,KAAKE,QAAQ,CAAC,UAAUI,cAAc,QAAQN,KAAKS,UAAU,CAAC,yBAAyB;YACvF,MAAM,EAAC3B,SAASF,OAAM,EAAC,GAAG,MAAM,MAAM,CAACjB,cAAcsC,UAAUE,QAAQ;YACvEvC,sBAAsB0B,GAAG,CAACgB,YAAY1B;QAC1C,OAAO,IAAIpB,GAAG4C,SAAS,CAACH,UAAUI,WAAW,IAAI;YAC7C,MAAMb,4BAA4BS;QACtC,CAAC;IACL;AACJ"}