{"version":3,"sources":["../../../src/ui/coin/createInterfaces.ts"],"sourcesContent":["import { BaseInteraction, Client, StringSelectMenuBuilder } from \"discord.js\";\nimport moment from \"moment\";\nimport { db } from \"../../database.js\";\nimport { CryptoApiData } from \"../../structs/cryptoapidata.js\";\nimport { UserSettingType } from \"../../structs/usersettings.js\";\nimport { getEmbedTemplate } from \"../templates.js\";\n\nexport async function genFavouritesMenu(interaction: BaseInteraction) {\n    let selectFavs = new StringSelectMenuBuilder()\n        .setCustomId(\"favCoins\")\n        .setPlaceholder(\"Quickly access your favourites...\");\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const favs = await db.all(\"select favouriteCrypto from user_settings where type=? and id=?\", UserSettingType[UserSettingType.FAVOURITE_CRYPTO], interaction.user.id);\n\n    for (let i = 0; i < favs.length; i++) {\n        const row = favs[i];\n        const favName = await db.get(\"select name from cmc_cache where id=?\", row.favouriteCrypto);\n        if (favName) {\n            selectFavs = selectFavs.addOptions({ label: favName.name, value: row.favouriteCrypto.toString() });\n        }\n        if (i == favs.length - 1) {\n            if (selectFavs.options.length == 0) {\n                selectFavs = selectFavs.addOptions({ label: \"Favourite a coin to add it here!\", value: \"default\" });\n            }\n        }\n    }\n\n    return selectFavs;\n\n}\n\nexport function genCoinEmbed(choice: CryptoApiData, client: Client) {\n    return getEmbedTemplate(client)\n        .setThumbnail(`https://s2.coinmarketcap.com/static/img/coins/128x128/${choice.id}.png`)\n        .setColor(choice.percent_change_24h < 0 ? 0xed4245 : 0x3ba55c)\n        .setTitle(`${choice.name} (${choice.symbol}-USD)`)\n        .setURL(`https://coinmarketcap.com/currencies/${choice.slug}`)\n        .setFields({ name: \"Price\", value: `$${choice.price < 1 ? choice.price.toPrecision(4) : Math.round(choice.price * 100) / 100} ${choice.percent_change_24h < 0 ? \"游댮\" : \"游릭\"}` },\n            { name: \"1h Change\", value: `${Math.round(choice.percent_change_1h * 100) / 100}% ${choice.percent_change_1h < 0 ? \"游댮\" : \"游릭\"}`, inline: true },\n            { name: \"24h Change\", value: `${Math.round(choice.percent_change_24h * 100) / 100}% ${choice.percent_change_24h < 0 ? \"游댮\" : \"游릭\"}`, inline: true },\n            { name: \"7d Change\", value: `${Math.round(choice.percent_change_7d * 100) / 100}% ${choice.percent_change_7d < 0 ? \"游댮\" : \"游릭\"}`, inline: true },\n            { name: \"24h Volume Change\", value: `${Math.round(choice.volume_change_24h * 100) / 100}% ${choice.volume_change_24h < 0 ? \"游댮\" : \"游릭\"}`, inline: true },\n            { name: \"Market Cap Dominance\", value: `${Math.round(choice.market_cap_dominance * 100) / 100}%`, inline: true },\n            { name: \"Last Updated\", value: `<t:${new Date(choice.last_updated).getTime}:R>` },\n        );\n}\n\n"],"names":["StringSelectMenuBuilder","db","UserSettingType","getEmbedTemplate","genFavouritesMenu","interaction","selectFavs","setCustomId","setPlaceholder","favs","all","FAVOURITE_CRYPTO","user","id","i","length","row","favName","get","favouriteCrypto","addOptions","label","name","value","toString","options","genCoinEmbed","choice","client","setThumbnail","setColor","percent_change_24h","setTitle","symbol","setURL","slug","setFields","price","toPrecision","Math","round","percent_change_1h","inline","percent_change_7d","volume_change_24h","market_cap_dominance","Date","last_updated","getTime"],"mappings":"AAAA,SAAkCA,uBAAuB,QAAQ,aAAa;AAE9E,SAASC,EAAE,QAAQ,oBAAoB;AAEvC,SAASC,eAAe,QAAQ,gCAAgC;AAChE,SAASC,gBAAgB,QAAQ,kBAAkB;AAEnD,OAAO,eAAeC,kBAAkBC,WAA4B,EAAE;IAClE,IAAIC,aAAa,IAAIN,0BAChBO,WAAW,CAAC,YACZC,cAAc,CAAC;IACpB,8DAA8D;IAC9D,MAAMC,OAAO,MAAMR,GAAGS,GAAG,CAAC,mEAAmER,eAAe,CAACA,gBAAgBS,gBAAgB,CAAC,EAAEN,YAAYO,IAAI,CAACC,EAAE;IAEnK,IAAK,IAAIC,IAAI,GAAGA,IAAIL,KAAKM,MAAM,EAAED,IAAK;QAClC,MAAME,MAAMP,IAAI,CAACK,EAAE;QACnB,MAAMG,UAAU,MAAMhB,GAAGiB,GAAG,CAAC,yCAAyCF,IAAIG,eAAe;QACzF,IAAIF,SAAS;YACTX,aAAaA,WAAWc,UAAU,CAAC;gBAAEC,OAAOJ,QAAQK,IAAI;gBAAEC,OAAOP,IAAIG,eAAe,CAACK,QAAQ;YAAG;QACpG,CAAC;QACD,IAAIV,KAAKL,KAAKM,MAAM,GAAG,GAAG;YACtB,IAAIT,WAAWmB,OAAO,CAACV,MAAM,IAAI,GAAG;gBAChCT,aAAaA,WAAWc,UAAU,CAAC;oBAAEC,OAAO;oBAAoCE,OAAO;gBAAU;YACrG,CAAC;QACL,CAAC;IACL;IAEA,OAAOjB;AAEX,CAAC;AAED,OAAO,SAASoB,aAAaC,MAAqB,EAAEC,MAAc,EAAE;IAChE,OAAOzB,iBAAiByB,QACnBC,YAAY,CAAC,CAAC,sDAAsD,EAAEF,OAAOd,EAAE,CAAC,IAAI,CAAC,EACrFiB,QAAQ,CAACH,OAAOI,kBAAkB,GAAG,IAAI,WAAW,QAAQ,EAC5DC,QAAQ,CAAC,CAAC,EAAEL,OAAOL,IAAI,CAAC,EAAE,EAAEK,OAAOM,MAAM,CAAC,KAAK,CAAC,EAChDC,MAAM,CAAC,CAAC,qCAAqC,EAAEP,OAAOQ,IAAI,CAAC,CAAC,EAC5DC,SAAS,CAAC;QAAEd,MAAM;QAASC,OAAO,CAAC,CAAC,EAAEI,OAAOU,KAAK,GAAG,IAAIV,OAAOU,KAAK,CAACC,WAAW,CAAC,KAAKC,KAAKC,KAAK,CAACb,OAAOU,KAAK,GAAG,OAAO,GAAG,CAAC,CAAC,EAAEV,OAAOI,kBAAkB,GAAG,IAAI,MAAO,GAAI,CAAC,CAAC;IAAC,GAC1K;QAAET,MAAM;QAAaC,OAAO,CAAC,EAAEgB,KAAKC,KAAK,CAACb,OAAOc,iBAAiB,GAAG,OAAO,IAAI,EAAE,EAAEd,OAAOc,iBAAiB,GAAG,IAAI,MAAO,GAAI,CAAC,CAAC;QAAEC,QAAQ,IAAI;IAAC,GAC/I;QAAEpB,MAAM;QAAcC,OAAO,CAAC,EAAEgB,KAAKC,KAAK,CAACb,OAAOI,kBAAkB,GAAG,OAAO,IAAI,EAAE,EAAEJ,OAAOI,kBAAkB,GAAG,IAAI,MAAO,GAAI,CAAC,CAAC;QAAEW,QAAQ,IAAI;IAAC,GAClJ;QAAEpB,MAAM;QAAaC,OAAO,CAAC,EAAEgB,KAAKC,KAAK,CAACb,OAAOgB,iBAAiB,GAAG,OAAO,IAAI,EAAE,EAAEhB,OAAOgB,iBAAiB,GAAG,IAAI,MAAO,GAAI,CAAC,CAAC;QAAED,QAAQ,IAAI;IAAC,GAC/I;QAAEpB,MAAM;QAAqBC,OAAO,CAAC,EAAEgB,KAAKC,KAAK,CAACb,OAAOiB,iBAAiB,GAAG,OAAO,IAAI,EAAE,EAAEjB,OAAOiB,iBAAiB,GAAG,IAAI,MAAO,GAAI,CAAC,CAAC;QAAEF,QAAQ,IAAI;IAAC,GACvJ;QAAEpB,MAAM;QAAwBC,OAAO,CAAC,EAAEgB,KAAKC,KAAK,CAACb,OAAOkB,oBAAoB,GAAG,OAAO,IAAI,CAAC,CAAC;QAAEH,QAAQ,IAAI;IAAC,GAC/G;QAAEpB,MAAM;QAAgBC,OAAO,CAAC,GAAG,EAAE,IAAIuB,KAAKnB,OAAOoB,YAAY,EAAEC,OAAO,CAAC,GAAG,CAAC;IAAC;AAE5F,CAAC"}